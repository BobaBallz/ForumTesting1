<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>wedonthaveaproperdomainname</title>
    <style>
        :root {
            --primary-color: #1DA1F2;
            --primary-dark: #1991DB;
            --background-color: #15202B;
            --card-color: #192734;
            --text-color: #FFFFFF;
            --secondary-text: #8899A6;
            --border-color: #38444D;
            --hover-color: #22303C;
            --success-color: #00BA7C;
            --error-color: #F4212E;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            min-height: 100vh;
            line-height: 1.5;
        }
        
        /* Main layout */
        .app-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar - channels */
        .sidebar {
            width: 250px;
            background: var(--card-color);
            border-right: 1px solid var(--border-color);
            padding: 15px;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }
        
        .sidebar-header {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
        }
        
        .channel-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .channel-item {
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .channel-item:hover {
            background-color: var(--hover-color);
        }
        
        .channel-item.active {
            background-color: var(--primary-color);
            font-weight: bold;
        }
        
        /* Main content */
        .main-content {
            flex-grow: 1;
            max-width: 800px;
            border-right: 1px solid var(--border-color);
            border-left: 1px solid var(--border-color);
        }
        
        .header {
            padding: 15px 20px;
            font-size: 20px;
            font-weight: bold;
            position: sticky;
            top: 0;
            background-color: rgba(21, 32, 43, 0.9);
            backdrop-filter: blur(5px);
            z-index: 10;
            border-bottom: 1px solid var(--border-color);
        }
        
        /* Posts */
        .posts-container {
            padding: 0;
        }
        
        .post {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.2s;
        }
        
        .post:hover {
            background-color: var(--hover-color);
        }
        
        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .post-username {
            font-weight: bold;
            margin-right: 5px;
        }
        
        .post-handle {
            color: var(--secondary-text);
            margin-right: 5px;
        }
        
        .post-timestamp {
            color: var(--secondary-text);
            font-size: 14px;
        }
        
        .post-content {
            margin: 10px 0;
            font-size: 15px;
            line-height: 1.5;
        }
        
        .post-image {
            max-width: 100%;
            max-height: 400px;
            border-radius: 15px;
            margin-top: 10px;
            border: 1px solid var(--border-color);
            object-fit: contain;
        }
        
        /* Post form */
        .post-form-container {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            bottom: 0;
            background-color: var(--background-color);
        }
        
        .post-form {
            display: flex;
            flex-direction: column;
        }
        
        .post-input {
            background: transparent;
            border: none;
            color: var(--text-color);
            font-size: 20px;
            resize: none;
            margin-bottom: 15px;
            min-height: 60px;
            outline: none;
            font-family: inherit;
        }
        
        .post-input::placeholder {
            color: var(--secondary-text);
        }
        
        .post-form-actions {
            display: flex;
            justify-content: space-between;
            border-top: 1px solid var(--border-color);
            padding-top: 15px;
        }
        
        .post-form-buttons {
            display: flex;
        }
        
        .post-form-button {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 20px;
            margin-right: 15px;
            cursor: pointer;
        }
        
        .post-submit {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 10px 20px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .post-submit:hover {
            background-color: var(--primary-dark);
        }
        
        .post-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* GIF search modal */
        .gif-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 100;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .gif-container {
            background-color: var(--card-color);
            border-radius: 15px;
            width: 500px;
            max-height: 80vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .gif-header {
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }
        
        .gif-title {
            font-weight: bold;
            font-size: 18px;
        }
        
        .gif-close {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 20px;
            cursor: pointer;
        }
        
        .gif-search {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .gif-search-input {
            width: 100%;
            padding: 10px 15px;
            border-radius: 30px;
            border: none;
            background-color: var(--background-color);
            color: var(--text-color);
            font-size: 15px;
        }
        
        .gif-results {
            flex-grow: 1;
            overflow-y: auto;
            padding: 10px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .gif-item {
            cursor: pointer;
            border-radius: 10px;
            overflow: hidden;
            aspect-ratio: 1;
            background-color: var(--hover-color);
        }
        
        .gif-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* Font Awesome icons */
        .fa {
            display: inline-block;
            font-style: normal;
            font-variant: normal;
            text-rendering: auto;
            line-height: 1;
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
        }
        
        .fa-image:before {
            content: "\f03e";
        }
        
        .fa-times:before {
            content: "\f00d";
        }
        
        /* Mobile responsiveness */
        @media (max-width: 1024px) {
            .sidebar {
                width: 80px;
                padding: 15px 10px;
            }
            
            .channel-item span {
                display: none;
            }
            
            .sidebar-header span {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: static;
                display: flex;
                overflow-x: auto;
                padding: 10px;
            }
            
            .sidebar-header {
                display: none;
            }
            
            .channel-list {
                display: flex;
            }
            
            .channel-item {
                margin-right: 10px;
                margin-bottom: 0;
                white-space: nowrap;
            }
            
            .channel-item span {
                display: inline;
            }
            
            .main-content {
                border: none;
            }
        }
        
        /* Accessibility improvements */
        button:focus, input:focus, textarea:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
        
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar with channels -->
        <aside class="sidebar" aria-label="Channels">
            <div class="sidebar-header">
                <span>Channels</span>
            </div>
            <ul class="channel-list">
                <li class="channel-item active" data-channel="general">
                    <span>General</span>
                </li>
                <li class="channel-item" data-channel="sonic">
                    <span>Sonic</span>
                </li>
                
                <li class="channel-item" data-channel="discussions">
                    <span>Discussions</span>
                </li>
                <li class="channel-item" data-channel="shitpost">
                    <span>Shitpost</span>
                </li>
                <li class="channel-item" data-channel="gaming">
                    <span>Gaming</span>
                </li>
            </ul>
        </aside>
        
        <!-- Main Content Area -->
        <main class="main-content">
            <div class="header">
                <span id="currentChannel">General</span>
            </div>
            
            <div class="post-form-container">
                <form class="post-form" id="postForm">
                    <label for="message" class="sr-only">Post message</label>
                    <textarea class="post-input" id="message" placeholder="What's happening?" aria-label="Post message"></textarea>
                    <div class="post-form-actions">
                        <div class="post-form-buttons">
                            <button type="button" class="post-form-button" id="gifButton">
                                <i class="fa-solid fa-image"></i>
                            </button>
                        </div>
                        <button type="submit" class="post-submit" disabled id="postSubmit">Post</button>
                    </div>
                </form>
            </div>
            
            <div class="posts-container" id="postList">
                <!-- Posts will be loaded here -->
            </div>
        </main>
    </div>
    
    <!-- GIF Search Modal -->
    <div class="gif-modal" id="gifModal">
        <div class="gif-container">
            <div class="gif-header">
                <div class="gif-title">Choose a GIF</div>
                <button class="gif-close" id="gifClose"><i class="fa fa-times"></i></button>
            </div>
            <div class="gif-search">
                <input type="text" class="gif-search-input" placeholder="Search for GIFs" id="gifSearchInput">
            </div>
            <div class="gif-results" id="gifResults">
                <!-- GIFs will be loaded here -->
            </div>
        </div>
    </div>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDG11gq-biaQLqqeQt7f-4N0s46J9Kf8kM",
            authDomain: "shutup-5f6f1.firebaseapp.com",
            databaseURL: "https://shutup-5f6f1-default-rtdb.firebaseio.com",
            projectId: "shutup-5f6f1",
            storageBucket: "shutup-5f6f1.firebasestorage.app",
            messagingSenderId: "268666553144",
            appId: "1:268666553144:web:502d3570b0c362e005f7cd",
            measurementId: "G-VRWGJHQTY0"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const auth = getAuth();

        // Tenor API Configuration
        const tenorApiKey = "AIzaSyCF2bc1tKxFthMF9OLZheJIQ3DqgaU0-jY";
        const tenorEndpoint = "https://tenor.googleapis.com/v2";

        let username = localStorage.getItem("username");
        if (!username) {
            username = "Anonymous" + Math.floor(Math.random() * 10000);
            localStorage.setItem("username", username);
        }

        signInAnonymously(auth)
            .then(() => console.log("Signed in as " + username))
            .catch((error) => console.error("Auth failed", error));

        let currentChannel = "general";

        document.addEventListener("DOMContentLoaded", () => {
            const postForm = document.getElementById("postForm");
            const postList = document.getElementById("postList");
            const messageInput = document.getElementById("message");
            const postSubmit = document.getElementById("postSubmit");
            const channelItems = document.querySelectorAll(".channel-item");
            const currentChannelDisplay = document.getElementById("currentChannel");
            const gifButton = document.getElementById("gifButton");
            const gifModal = document.getElementById("gifModal");
            const gifClose = document.getElementById("gifClose");
            const gifSearchInput = document.getElementById("gifSearchInput");
            const gifResults = document.getElementById("gifResults");

            // Enable/disable post button based on input
            messageInput.addEventListener("input", () => {
                postSubmit.disabled = messageInput.value.trim() === "";
            });

            // Load posts for current channel
            function loadChannel(channel) {
                currentChannel = channel;
                currentChannelDisplay.textContent = channel.charAt(0).toUpperCase() + channel.slice(1);
                
                // Update active channel in sidebar
                channelItems.forEach(item => {
                    item.classList.remove("active");
                    if (item.dataset.channel === channel) {
                        item.classList.add("active");
                    }
                });
                
                const postsRef = ref(database, `posts/${currentChannel}`);
                onValue(postsRef, (snapshot) => {
                    postList.innerHTML = "";
                    const posts = [];
                    
                    snapshot.forEach((childSnapshot) => {
                        posts.push({
                            id: childSnapshot.key,
                            ...childSnapshot.val()
                        });
                    });
                    
                    // Sort by timestamp (newest first)
                    posts.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
                    
                    posts.forEach(post => {
                        const postElement = createPostElement(post);
                        postList.appendChild(postElement);
                    });
                });
            }
            
            // Create a post element
            function createPostElement(post) {
                const postElement = document.createElement("div");
                postElement.className = "post";
                postElement.dataset.postId = post.id;
                
                const time = new Date(post.timestamp || Date.now()).toLocaleTimeString([], {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                let content = post.message;
                if (post.message.startsWith("http") && (post.message.endsWith(".gif") || post.message.includes("tenor.com"))) {
                    content = `<img src="${post.message}" alt="User posted GIF" class="post-image">`;
                }
                
                postElement.innerHTML = `
                    <div class="post-header">
                        <span class="post-username">${post.username}</span>
                        <span class="post-handle">@${post.username.toLowerCase().replace(/\s/g, '')}</span>
                        <span class="post-timestamp">· ${time}</span>
                    </div>
                    <div class="post-content">${content}</div>
                `;
                
                return postElement;
            }
            
            // Channel click handlers
            channelItems.forEach(item => {
                item.addEventListener("click", () => {
                    loadChannel(item.dataset.channel);
                });
            });
            
            // Post form submission
            postForm.addEventListener("submit", (event) => {
                event.preventDefault();
                const message = messageInput.value.trim();
                
                if (message !== "") {
                    push(ref(database, `posts/${currentChannel}`), {
                        username,
                        message,
                        timestamp: Date.now()
                    });
                    
                    messageInput.value = "";
                    postSubmit.disabled = true;
                }
            });

            // GIF functionality
            // Load trending GIFs when modal opens
            function loadTrendingGifs() {
                fetch(`${tenorEndpoint}/featured?key=${tenorApiKey}&limit=12`)
                    .then(response => response.json())
                    .then(data => {
                        displayGifs(data.results);
                    })
                    .catch(error => {
                        console.error("Error fetching trending GIFs:", error);
                        displayMockGifs();
                    });
            }

            // Search GIFs based on query
            function searchGifs(query) {
                if (!query) {
                    loadTrendingGifs();
                    return;
                }
                
                fetch(`${tenorEndpoint}/search?q=${encodeURIComponent(query)}&key=${tenorApiKey}&limit=12`)
                    .then(response => response.json())
                    .then(data => {
                        displayGifs(data.results);
                    })
                    .catch(error => {
                        console.error("Error searching GIFs:", error);
                        displayMockGifs(query);
                    });
            }

            // Display GIFs in the results panel
            function displayGifs(gifs) {
                gifResults.innerHTML = "";
                
                if (!gifs || gifs.length === 0) {
                    gifResults.innerHTML = `<div style="grid-column: 1 / -1; text-align: center; padding: 20px; color: #8899A6;">No GIFs found</div>`;
                    return;
                }
                
                gifs.forEach(gif => {
                    const gifUrl = gif.media_formats.gif.url;
                    const gifElement = document.createElement("div");
                    gifElement.className = "gif-item";
                    gifElement.innerHTML = `<img src="${gifUrl}" alt="GIF" loading="lazy">`;
                    gifElement.addEventListener("click", () => {
                        messageInput.value = gifUrl;
                        postSubmit.disabled = false;
                        gifModal.style.display = "none";
                    });
                    gifResults.appendChild(gifElement);
                });
            }

            // Fallback mock GIFs
            function displayMockGifs(query = "") {
                const mockGifs = [
                    "https://media.tenor.com/YKZRZEJ7Z4gAAAAd/pepe-laugh.gif",
                    "https://media.tenor.com/9XaPusfQH1kAAAAd/pepe-pepe-the-frog.gif",
                    "https://media.tenor.com/3B5iZJ8n5JYAAAAd/pepe-pepehands.gif",
                    "https://media.tenor.com/5ry-200hErMAAAAd/huh-cat.gif",
                    "https://media.tenor.com/1UoL-HJFGDAAAAAd/soyjak-pointing-soyjaks.gif",
                    "https://media.tenor.com/6g7qm7vUfzYAAAAd/soyjak-dancing.gif",
                    "https://media.tenor.com/XDBbZ4Jg-roAAAAd/pepe-clown.gif",
                    "https://media.tenor.com/2C7tgjXfikAAAAAd/pepe-pepejam.gif",
                    "https://media.tenor.com/1bJkX7OqF5kAAAAd/pepe-pepe-sad.gif",
                    "https://media.tenor.com/5ZqyD6dX3JQAAAAd/pepe-pepe-smile.gif",
                    "https://media.tenor.com/2xrQjXqQ9QAAAAAd/pepe-pepe-cry.gif",
                    "https://media.tenor.com/7H1dQZ7Q9QAAAAAd/pepe-pepe-laugh.gif"
                ].filter(gif => gif.includes(query.toLowerCase()));
                
                gifResults.innerHTML = "";
                
                if (mockGifs.length === 0) {
                    gifResults.innerHTML = `<div style="grid-column: 1 / -1; text-align: center; padding: 20px; color: #8899A6;">No GIFs found for "${query}"</div>`;
                    return;
                }
                
                mockGifs.forEach(gifUrl => {
                    const gifElement = document.createElement("div");
                    gifElement.className = "gif-item";
                    gifElement.innerHTML = `<img src="${gifUrl}" alt="GIF">`;
                    gifElement.addEventListener("click", () => {
                        messageInput.value = gifUrl;
                        postSubmit.disabled = false;
                        gifModal.style.display = "none";
                    });
                    gifResults.appendChild(gifElement);
                });
            }

            // GIF button click handler
            gifButton.addEventListener("click", (e) => {
                e.preventDefault();
                gifModal.style.display = "flex";
                loadTrendingGifs();
            });

            // Close GIF modal
            gifClose.addEventListener("click", () => {
                gifModal.style.display = "none";
            });

            // GIF search input handler
            gifSearchInput.addEventListener("input", (e) => {
                searchGifs(e.target.value);
            });

            // Close GIF modal when clicking outside
            document.addEventListener("click", (e) => {
                if (e.target === gifModal) {
                    gifModal.style.display = "none";
                }
            });
            
            // Initialize with general channel
            loadChannel(currentChannel);
        });
    </script>
</body>
</html>